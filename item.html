try {
  const res = await fetch(apiUrl, {
    headers: {
      Authorization: `Bearer ${airtableToken}`
    }
  });

  if (!res.ok) {
    const text = await res.text();
    document.body.innerHTML = `Airtable Error: ${res.status} <br/> ${text}`;
    return;
  }

  const data = await res.json();
  const isRegistered = data.records.length > 0;

  const redirectUrl = isRegistered
    ? `https://tally.so/r/wzRyXk?item_id=${itemId}`  // FOUND
    : `https://tally.so/r/mKZ2zD?item_id=${itemId}`; // REGISTER

  window.location.href = redirectUrl;

} catch (error) {
  document.body.innerHTML = "Error fetching from Airtable.";
  console.error(error);
}
